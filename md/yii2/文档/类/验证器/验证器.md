## 验证器 
* 类名：`\yii\validators\Validator`
* 继承：`\yii\base\Component`
* 定义时须继承的类：`\yii\validators\Validator`
* 官方文档
    * [验证器类](https://www.yiichina.com/doc/api/2.0/yii-validators-validator)
    * [验证器书写规则](https://www.yiichina.com/doc/guide/2.0/tutorial-core-validators) 
* 验证器书写规则说明(`rules()`)
    * 使用方法：在模型中覆写`rules()`方法,在`rules()`方法中要使用的验证器类名: 
        * 内置验证器：`builtInValidators`成员变量中对应的验证器简写
        * 自定义验证器：名称空间完全限定的类名
    * 验证规则`model rules()`结构
        ```php
        public function rules()
        {
            return [
                [
                    ["name","email"],   //string|array,必需。要验证的属性名列表,当只有一个属性需要验证时,可使用字符串
                    "required",         //string,必需。验证器类名
                    "param1"=>"val1",   //mixed,视指定的验证器确定是否必需。可指定"键"=>"值"对来初始化指定的验证器的属性值
                    "param2"=>"val2",   //同上
                ]
            ];
        }
        ```
    * 内置验证器
        * 公共属性(属性的全部信息可在对应的验证器类定义中查看)
            * `except`:string|array。校验器不应该应用的情景,适用的场景列表,当只有一个场景时,可使用字符串。不指定时默认为空
            * `on`:string|array。校验器应该应用的情景,适用的场景列表,当只有一个场景时,可使用字符串。不指定时默认`default`
            * `message`:string。验证错误时的消息,可以使用占位符,详见`重要特新 自定义校验器 服务端校验 message`。默认为空字符串
            * `skipOnEmpty`:bool。当输入为空时是否跳过验证。默认为`true`
            * `isEmpty`:bool callable($value)。判断`skipOnEmpty`为空的方法。不指定时默认为`isEmpty()`方法
            * `skipOnError`:bool。当被校验的属性根据之前的校验规则已经有一些校验错误时是否跳过。默认为`true`
            * `when`:bool callable($model, $attribute)。是否开启服务端校验。默认开启
            * `enableClientValidation`:bool。是否开启客户端校验。默认开启。优先级高于`whenClient`
            * `whenClient`:string。js函数,js函数应返回bool值。是否开启客户端校验。默认开启(如果支持) 
        * 类型 
            * `boolean`
                * 功能：验证是否是布尔型数据
                * 类：`yii\validators\BooleanValidator`
                * 属性
                    * `trueValue`:mixed。真值,用于对比以验证数据。默认为`'1'`
                    * `falseValue`:mixed。假值,用于对比以验证数据。默认为`'0'`
                    * `strict`:bool。严格匹配模式。true(===)|false(==)。默认为false
                * 验证规则`model rules()`结构:
                    ```php
                    [
                        // 检查 "selected" 是否为 0 或 1，无视数据类型
                        ['selected', 'boolean'],

                        // 检查 "deleted" 是否为布尔类型，即 true 或 false
                        ['deleted', 'boolean', 'trueValue' => true, 'falseValue' => false, 'strict' => true],
                    ]
                    ```
            * `captcha`(图形验证码) 
                * 功能：验证码检测
                * 类：`yii\captcha\CaptchaValidator`
                * 属性
                    * `caseSensitive`:bool。是否区分大小写。默认为`false`
                    * `captchaAction`:string。验证码图片action路径。默认为`site/captcha`
                    * `skipOnEmpty`:bool。当输入为空时是否路过验证。默认为`false`
                * 验证规则`model rules()`和`controller actions()`结构:
                    * `model rules()`
                        ```php
                        public function rules()
                        {
                            return [
                                ['verifyCode',"captcha","captchaAction"=>"site/captcha_test"]
                            ];
                        }
                        ```
                    * `controller actions()`
                        * 配置
                            ```php 
                            public function actions()
                            {
                                return [
                                    "captcha_test"=>[
                                        "class"=>'yii\captcha\CaptchaAction',
                                        "fixedVerifyCode"=>null
                                    ],
                                ];
                            }
                            ```
                        * 访问`CONTROLLER_ID/captcha_test`时`url`中携带`refresh=1`参数时可获取新的验证码`url`等信息，包括
                            * `hash1`
                                * 类型：int
                                * 含义：区分大小写的hash验证
                                * 验证算法(仅用于客户端验证)
                                    * 说明  
                                        1. 把输入的验证码分割为单个字符
                                        1. 每个字符取第一个字节的`ascii`十进制值
                                        1. 每个`ascii`十进制值求和
                                        1. 如果`hash1`与求和值相等则表明验证码正确
                                    * 示例
                                        ```php
                                        $hash="640";

                                        $input_str='safooh';
                                        // 下面这句仅用于`hash2`，不区分大小写
                                        // $input_str=strtolower($input_str);
                                        $input_str_len=strlen($input_str);
                                        $input_str_hash=0;

                                        for($i=0;$i<$input_str_len;++$i){
                                            $input_str_hash+=ord($input_str[$i]);
                                        }
                                        
                                        if($hash==$input_str_hash){
                                            echo "验证通过";
                                        }else{
                                            echo "验证失败";
                                        }
                                        ```

                                        ```js
                                        var hash="640";

                                        var input_str='safooh';
                                        // 下面这句仅用于`hash2`，不区分大小写
                                        // input_str=input_str.toLowerCase();
                                        var input_str_len=input_str.length;
                                        var input_str_hash=0;

                                        for(var i=0;i<input_str_len;++i){
                                            input_str_hash+=input_str.charCodeAt(i);
                                        }

                                        if(hash==input_str_hash){
                                            console.log("验证通过");
                                        }else{
                                            console.log("验证失败");
                                        }
                                        ```
                            * `hash2`
                                * 类型：int
                                * 含义：不区分大小写的hash验证
                                * 验证算法(仅用于客户端验证)：同`hash1`
                            * `url`:string
                                * 类型：string
                                * 含义：验证码`url`，可直接访问
                        1. 访问上一步中返回的`url`即可显示验证码 
            * `compare`
                * 功能：对比验证
                * 类：`yii\validators\CompareValidator`
                * 属性
                    * `compareAttribute`:string。被验证的属性将和`此属性指定的属性名相等的其他被验证的属性值`对比。默认值:`被验证的属性名_repeat`
                    * `compareValue`:mixed。模型中被验证的属性将与此值对比。优先级高于`compareAttribute`
                    * `operator`:string。操作符，如下：
                        * `==`：检查两值是否相等。比对为非严格模式。默认
                        * `===`：检查两值是否全等。比对为严格模式。
                        * `!=`：检查两值是否不等。比对为非严格模式。
                        * `!==`：检查两值是否不全等。比对为严格模式。
                        * `>`：检查待测目标值是否大于给定被测值。
                        * `>=`：检查待测目标值是否大于等于给定被测值。
                        * `<`：检查待测目标值是否小于给定被测值。
                        * `<=`：检查待测目标值是否小于等于给定被测值。
                    * `type`:string 
                        * 取值
                            * `string`:按字节对比
                                * 对比不等于时:从前往后,只要对比到一个字节符合要求则认为验证通过
                                * 对比不等时:所有字节相等时则认为验证通过
                            * `number`:按数值对比,值满足要求才通过
                        * 默认
                            * 不指定`type`且指定了`compareValue`属性时会自动判断`compareValue`的类型作为默认值
                            * 不指定`type`且未指定`compareValue`属性时默认为`string`
                    * `message`:string。用户定义错误消息。 它可包含如下的占位符：
                        * {attribute}: 待校验的属性标签名
                        * {value}: 待校验的属性值
                        * {compareValue}: 比较的值
                        * {compareAttribute}: 比较的属性标签
                        * {compareValueOrAttribute}: 比较的值或者属性标签
                * 验证规则`model rules()`结构:
                    ```php
                    [
                        // 检查 "password" 属性的值是否与 "password_repeat" 的值相同
                        ['password', 'compare'],

                        // 和上一个相同，只是明确指定了需要对比的属性字段
                        ['password', 'compare', 'compareAttribute' => 'password_repeat'],
                        
                        // 检查年龄是否大于等于 30
                        ['age', 'compare', 'compareValue' => 30, 'operator' => '>='],
                    ]
                    ```
            * `date`、`datetime`、`time`
                * 功能：日期验证、日期时间时间验证、时间验证
                * 类：`yii\validators\DateValidator`
                * 属性
                    * `format`:string。输入的时间日期格式
                        * [ICU日期格式](http://userguide.icu-project.org/formatparse/datetime#TOC-Date-Time-Format-Syntax)
                        * php日期格式：以`php:`作为起始。[php日期格式](https://www.php.net/manual/zh/datetime.createfromformat.php)
                        * 默认：`Yii::$app->formatter->dateFormat`
                    * `timeZone`:string。输入的时间的时区，当验证类型为`date`时，此值无效，输入时区固定为`UTC +0`
                    * `min`:null|string|int。输入的时间日期的下限
                        * null:无限制。默认
                        * int:时间戳
                        * string:描述时间的字符串。与`format`格式相同
                    * `max`:null|string|int。输入的时间日期的上限
                        * null:无限制。默认
                        * int:时间戳
                        * string:描述时间的字符串。与`format`格式相同
                    * `tooBig`:string。用户自定义错误消息当值大于`max`,使用方法与`message`相同
                    * `tooSmall`:string。用户自定义错误消息当值大于`min`,使用方法与`message`相同
                    * `timestampAttribute`:string，输出的时间。未设置则忽略。输入的日期时间被`timestampAttributeFormat`格式化后存储到的属性的名称，可以设置为和被验证的属性相同
                    * `timestampAttributeFormat`:string，输出的时间格式。填充`timestampAttribute`所指定属性的格式。默认使用`UNIX 时间戳`填充。格式同`format`
                    * `timestampAttributeTimeZone`:string，输出的时间时区。`timestampAttribute`的时区，详见[时区](http://php.p2hp.com/manual/zh/timezones.php)。默认`UTC`时区
                * 验证规则`model rules()`结构:
                    ```php
                    return [
                        ["date","date","format"=>"php:Y-m-d"],
                    ];
                    ```
            * `default`
                * 功能：当输入值为空时，将其指定一个值
                * 类：`yii\validators\DefaultValueValidator`
                * 属性
                    * `value`:mixed|mixed callback($model,$attribute),当输入值为空时，将其指定为此值
                    * `isEmpty`:bool callback($value),判断为空的回调函数。未指定时使用`isEmpty()`函数
                * 验证规则`model rules()`结构:
                    ```php
                    return [
                        ["default","default","value"=>"123","isEmpty"=>function($value){if(trim($value)==="")return true;return false;}],
                    ];
                    ```
            * `double`、`integer`
                * 功能：验证浮点数、整型
                * 类：`yii\validators\NumberValidator`
                * 属性
                    * `max`:mixed,上限值（含界点）。若不设置，则验证器不检查上限。
                    * `min`:mixed,下限值（含界点）。若不设置，则验证器不检查下限。
                * 验证规则`model rules()`结构:
                    ```php
                    return [
                        ["default","default","value"=>"123","isEmpty"=>function($value){if(trim($value)==="")return true;return false;}],
                    ];
                    ```
            
            
            
            

* 重要特性
    * 初始化
        * 特点：在类被构造时自动调用
        * 形式：有两种，如下：
            ```php
            public function __construct($config = [])
            {
                //先调用父类的构造函数
                parent::__construct($config);
                //然后写初始化语句
                //...
            }
            ```
            ```php
            public function init()
            {
                //先调用父类的初始化函数 
                parent::init();
                //初始化语句
                //...
            }
            ```
    * 自定义验证器
        * 客户端校验
            * 成员变量
                * `enableClientValidation`
                    * 类型：bool。重要属性
                    * 功能：是否启用这个校验器的客户端校验。默认true
                    * 权限：读写。优先级高于`whenClient`
                * `whenClient`
                    * 类型：string。js函数的返回值应为bool
                    * 功能：是否启用这个校验器的客户端校验。默认true
                    * 权限：读写
            * 成员方法
                * `public string|null clientValidateAttribute($model, $attribute, $view)`
                    * 功能：用于客户端校验的 JS 代码
                    * 参数
                        * model:yii\base\Model,使用这个校验器的模型实例
                        * attribute:string,属性名
                        * view:yii\web\View,将要被用于渲染的视图对象实例
                    * 返回值：string|null,客户端校验 JS 脚本代码。如果校验器不支持的话，返回 null ，如下预定义 JS 变量可以用于校验代码中：
                        * attribute: 描述被校验属性的对象
                            * id: 唯一 ID 用于在表单中标识这个属性（例如： "loginform-username"）
                            * name: 属性名称或表达式（例如：表单输入时，可以为 "[0]content" ）
                            * container: 输入容器的 jQuery 选择器
                            * input: 表单上下文输入字段的 jQuery 选择器
                            * error: 容器上下文错误标签的 jQuery 选择器
                            * status: 输入字段的状态，0：空的，没有输入，1：校验过了，2：待校验，3：校验中
                        * value: 被校验的值
                        * messages: 保存属性校验错误消息的数组
                        * deferred: 保存 deferred 对象的数组用于异步执行校验
                        * $form: jQuery 对象用于保存表单元素 
                * `public array getClientOptions($model, $attribute)`
                    * 功能：获取客户端校验参数
                    * 参数
                        * model:yii\base\Model,使用这个校验器的模型实例
                        * attribute:string,被校验的属性名称
                    * 返回值：客户端校验参数
        * 服务端校验
            * 成员变量
                * `when`
                    * 类型：bool callable($model,$attribute)
                    * 功能：是否启用这个校验器。默认true
                    * 权限：读写
                * `skipOnEmpty`
                    * 类型：bool
                    * 功能：当被校验的属性值为null或者空字符串时时是(`true`)否(`false`)跳过验证。默认为`true`
                    * 权限：读写 
                * `skipOnError`
                    * 类型：bool
                    * 功能：当被校验的属性根据之前的校验规则已经有一些校验错误时是(`true`)否(`false`)跳过验证。默认为`true`
                    * 权限：读写
                * `message`
                    * 类型：string
                    * 功能：存储错误消息，如果验证错误则被加入到错误信息中。可使用占位符,占位符将会被使用此校验器的模型中的`generateAttributeLabel()`方法的返回值替换
                        * 默认的占位符
                            * `{attribute}`: 被校验的属性标签
                            * `{value}`: 被校验的属性值 
                        * 自定义占位符
                            * `{自定义占位符名}`
                    * 权限：读写 
            * 成员方法
                * `protected array|null validateValue($value)`
                    * 功能：验证逻辑,被`validateAttribute()`调用。必需覆写
                    * 参数：value:mixed,要验证的数据
                    * 返回值：bool,通过|未通过验证
                * `public void validateAttribute($model, $attribute)`
                    * 功能：调用验证逻辑(`validateValue()`)与验证结果处理(调用`addError()`添加错误消息),被`validateAttributes()`调用。必需覆写
                    * 参数
                        * model:被验证的模型
                        * attribute:被验证的模型中的属性名
                    * 返回值：bool,通过|未通过验证
    * 属性
        * 成员变量
            * `except`
                * 类型：array
                * 功能：指定此验证器不使用的情景。空数组适用于所有情景
                * 权限：读写。优先级高于`on`
            * `on`
                * 类型：array。此值决定`isActive()`的返回值
                * 功能：指定此验证器使用的情景。空数组适用于所有情景
                * 权限：读写
            * `attributes`
                * 类型：array|string 
                * 功能：要验证的属性名(可能含有`!`前缀)。string只适用于一个属性,array适用于一个或多个属性
                * 权限：读写 
            * `builtInValidators`
                * 类型：static array
                * 功能：验证器与简写对应表
                    * `boolean`: `yii\validators\BooleanValidator`
                    * `captcha`: `yii\captcha\CaptchaValidator`
                    * `compare`: `yii\validators\CompareValidator`
                    * `date`: `yii\validators\DateValidator`
                    * `datetime`: `yii\validators\DateValidator`
                    * `time`: `yii\validators\DateValidator`
                    * `default`: `yii\validators\DefaultValueValidator`
                    * `double`: `yii\validators\NumberValidator`
                    * `integer`: `yii\validators\NumberValidator`
                    * `each`: `yii\validators\EachValidator`
                    * `email`: `yii\validators\EmailValidator`
                    * `exist`: `yii\validators\ExistValidator`
                    * `file`: `yii\validators\FileValidator`
                    * `filter`: `yii\validators\FilterValidator`
                    * `image`: `yii\validators\ImageValidator`
                    * `in`: `yii\validators\RangeValidator`
                    * `match`: `yii\validators\RegularExpressionValidator`
                    * `required`: `yii\validators\RequiredValidator`
                    * `safe`: `yii\validators\SafeValidator`
                    * `string`: `yii\validators\StringValidator`
                    * `trim`: `yii\validators\FilterValidator`
                    * `unique`: `yii\validators\UniqueValidator`
                    * `url`: `yii\validators\UrlValidator`
                    * `ip`: `yii\validators\IpValidator`
                * 权限：只读
            * `isEmpty`
                * 类型：bool callable($value)
                * 功能：空值校验
                * 权限：读写
        * 成员方法
            * `public array getAttributeNames()`
                * 功能：获取真实的属性名称(不含`!`前缀)
                * 参数：无 
                * 返回值: 返回属性名称列表
            * `public array getValidationAttributes($attributes = null)`
                * 功能：获取真实的属性名称(不含`!`前缀)
                * 参数  
                    * attributes
                        * array,属性名称组成的数组
                        * string,只获取一个属性名称,亦可使用字符串
                        * null,获取所有的属性名称
                * 返回值: 返回属性名称列表 
            * `public static yii\validators\Validator createValidator($type, $model, $attributes, $params = [])`
                * 功能：创建校验器实例
                * 参数
                    * type：string|callable,校验器类型,可取以下值
                        * $builtInValidators 列表中的内建校验器名称
                        * 模型类的方法名
                        * 匿名函数
                        * 校验器类名
                    * model：yii\base\Model，被校验的数据模型实例
                    * attributes：array|string,被校验的属性名，它可以是属性名称数组，也可以是逗号分隔的属性名称字符串
                    * params：array,校验器属性的初始值。[属性名=>属性值]
                * 返回值：yii\validators\Validator,生成的校验器实例 
            * `public boolean isEmpty($value)`
                * 功能：检测指定的值是否为空。如果它是一个 null，一个空的数组，或者一个空字符串，那么它会被认为是一个空值
                * 参数：value:mixed,待检测的值
                * 返回值：bool。是|否为空
            * `public boolean validate($value, &$error = null)`
                * 功能：校验一个指定的值。当model调用`validate()时`该函数自动被调用;
                * 参数：
                    * value:mixed,被校验的数据值
                    * error:string,如果校验失败，被返回的错误消息
                * 返回值：bool。数据是|否合法
            * `public void addError($model, $attribute, $message, $params = [])`
                * 功能：为指定的属性添加一条错误消息
                * 参数
                    * model:yii\base\Model,使用这个校验器的模型实例
                    * attribute:string,属性名
                    * error:string,错误消息
                    * params:array,用于替换错误消息中占位符的变量,形式为[占位符字符串(不含中括号)=>变量或值]
                * 返回值：无
            * `public void validateAttributes($model, $attributes = null)`
                * 功能：校验多个指定的值。当model调用`validate()时`该函数自动被调用;
                * 参数：
                    * model：yii\base\Model，被校验的数据模型实例
                    * attributes
                        * array,被校验的属性列表
                        * string,被校验的属性名
                        * null,每个属性都会被校验
                * 返回值：无
            * `public boolean isActive($scenario)`
                * 功能：判断当前校验器在当前情景和属性下是否是激活状态。
                * 参数：scenario:string,情景名
                * 返回值：bool。是|否处于激活状态，以下情况返回true
                    * 这个校验器的 on 属性是空的 
                    * 这个校验器的 on 属性包含指定的情景。
            * `protected string formatMessage($message, $params)`
                * 功能：消息国际化转换。通常在类内处理消息时调用此方法
                * 参数
                    * message:string,将要被转换的消息
                    * params:array,用于替换错误消息中占位符的变量,形式为[占位符字符串(不含中括号)=>变量或值]
                * 返回值：string。转换后的消息
    
    