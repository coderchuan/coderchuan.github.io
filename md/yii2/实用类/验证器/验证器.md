## 验证器 
* 类名：`\yii\validators\Validator`
* 继承
    * `\yii\base\Component`
* 定义时须继承的类
    * `\yii\validators\Validator`
* 官方文档
    * [验证器类](https://www.yiichina.com/doc/api/2.0/yii-validators-validator)
    * [验证器书写规则](https://www.yiichina.com/doc/guide/2.0/tutorial-core-validators) 
* 验证器书写规则(`rules()`)
    * 使用方法：在模型中覆写`rules()`方法,在`rules()`方法中要使用的验证器类名: 
        * 内置验证器：`builtInValidators`成员变量中对应的验证器简写
        * 自定义验证器：名称空间完全限定的类名
    * 验证规则的结构
        ```php
        public function rules()
        {
            return [
                [
                    ["name","email"],   //string|array,必需。要验证的属性名列表,当只有一个属性需要验证时,可使用字符串
                    "required",         //string,必需。验证器类名
                    "param1"=>"val1",   //mixed,视指定的验证器确定是否必需。可指定"键"=>"值"对来初始化指定的验证器的属性值
                    "param2"=>"val2",   //同上
                ]
            ];
        }
        ```
    * 内置验证器
        * 公共属性
            * `except`:string|array。校验器不应该应用的情景,适用的场景列表,当只有一个场景时,可使用字符串。不指定时默认为空
            * `on`:string|array。校验器应该应用的情景,适用的场景列表,当只有一个场景时,可使用字符串。不指定时默认`default`
            * `message`:string。验证错误时的消息。默认为空字符串
            * `skipOnEmpty`:bool。当输入为空时是否跳过验证。默认为`true`
            * `isEmpty`:bool callable($value)。判断`skipOnEmpty`为空的方法。不指定时默认为`isEmpty()`方法
            * `skipOnError`:bool。当被校验的属性根据之前的校验规则已经有一些校验错误时是否跳过。默认为`true`
            * `when`:bool callable($model, $attribute)。是否开启服务端校验。默认开启
            * `enableClientValidation`:bool。是否开启客户端校验。默认开启。优先级高于`whenClient`
            * `whenClient`:string。js函数,js函数应返回bool值。是否开启客户端校验。默认开启(如果支持) 
        * 类型 
            * `boolean`
                * 功能：验证是否是布尔型数据
                * 属性
                    * `trueValue`:mixed。真值,用于对比以验证数据。默认为`'1'`
                    * `falseValue`:mixed。假值,用于对比以验证数据。默认为`'0'`
                    * `strict`:bool。严格匹配模式。true(===)|false(==)。默认为false
                * 配置示例:`['deleted', 'boolean', 'trueValue' => true, 'falseValue' => false, 'strict' => false]`
            * `captcha`(图形验证码) 
                * 功能：验证码检测
                * 属性
                    * `caseSensitive`:bool。是否区分大小写。默认为`false`
                    * `captchaAction`:string。验证码图片action路径。默认为`site/captcha`
                * 配置示例
                    * 传统表单整页提交
                        * `model`(TestModel)
                            ```php
                            public function rules()
                            {
                                return [
                                    ['verifyCode',"captcha","captchaAction"=>"site/captcha_test"]
                                ];
                            }
                            ```
                        * `controller`
                            ```php 
                            use app\models\TestModel;
                            
                            public function actions()
                            {
                                return [
                                    "captcha_test"=>[
                                        "class"=>'yii\captcha\CaptchaAction',
                                        "fixedVerifyCode"=>null
                                    ],
                                ];
                            }
                            public function actionIndex()
                            {
                                $model=new TestModel();
                                return $this->render("index",["model"=>$model]);
                            }
                            public function actionCheck()
                            {
                                $model=new TestModel();
                                $model->load($_REQUEST);

                                if($model->validate()){
                                    return json_encode(["验证成功"]);
                                }else{
                                    $errors=$model->getFirstErrors();
                                    return json_encode($errors);
                                }
                            }
                            ```
                        * `view`
                            ```php
                            use yii\captcha\Captcha;
                            use yii\widgets\ActiveForm;

                            $form=ActiveForm::begin(['action'=>"/index.php?r=site/check","method"=>'post']);
                            echo $form->field($model,'verifyCode')->widget(Captcha::class,['captchaAction'=>'captcha_test']);
                            ActiveForm::end();
                            ```
                    * ajax提交表单
                        * 

* 重要特性
    * 初始化
        * 特点：在类被构造时自动调用
        * 形式：有两种，如下：
            ```php
            public function __construct($config = [])
            {
                //先调用父类的构造函数
                parent::__construct($config);
                //然后写初始化语句
                //...
            }
            ```
            ```php
            public function init()
            {
                //先调用父类的初始化函数 
                parent::init();
                //初始化语句
                //...
            }
            ```
    * 自定义验证器
        * 客户端校验
            * 成员变量
                * `enableClientValidation`
                    * 类型：bool。重要属性
                    * 功能：是否启用这个校验器的客户端校验。默认true
                    * 权限：读写。优先级高于`whenClient`
                * `whenClient`
                    * 类型：string。js函数的返回值应为bool
                    * 功能：是否启用这个校验器的客户端校验。默认true
                    * 权限：读写
            * 成员方法
                * `public string|null clientValidateAttribute($model, $attribute, $view)`
                    * 功能：用于客户端校验的 JS 代码
                    * 参数
                        * model:yii\base\Model,使用这个校验器的模型实例
                        * attribute:string,属性名
                        * view:yii\web\View,将要被用于渲染的视图对象实例
                    * 返回值：string|null,客户端校验 JS 脚本代码。如果校验器不支持的话，返回 null ，如下预定义 JS 变量可以用于校验代码中：
                        * attribute: 描述被校验属性的对象
                            * id: 唯一 ID 用于在表单中标识这个属性（例如： "loginform-username"）
                            * name: 属性名称或表达式（例如：表单输入时，可以为 "[0]content" ）
                            * container: 输入容器的 jQuery 选择器
                            * input: 表单上下文输入字段的 jQuery 选择器
                            * error: 容器上下文错误标签的 jQuery 选择器
                            * status: 输入字段的状态，0：空的，没有输入，1：校验过了，2：待校验，3：校验中
                        * value: 被校验的值
                        * messages: 保存属性校验错误消息的数组
                        * deferred: 保存 deferred 对象的数组用于异步执行校验
                        * $form: jQuery 对象用于保存表单元素 
                * `public array getClientOptions($model, $attribute)`
                    * 功能：获取客户端校验参数
                    * 参数
                        * model:yii\base\Model,使用这个校验器的模型实例
                        * attribute:string,被校验的属性名称
                    * 返回值：客户端校验参数
        * 服务端校验
            * 成员变量
                * `when`
                    * 类型：bool callable($model,$attribute)
                    * 功能：是否启用这个校验器。默认true
                    * 权限：读写
                * `skipOnEmpty`
                    * 类型：bool
                    * 功能：当被校验的属性值为null或者空字符串时时是(`true`)否(`false`)跳过验证。默认为`true`
                    * 权限：读写 
                * `skipOnError`
                    * 类型：bool
                    * 功能：当被校验的属性根据之前的校验规则已经有一些校验错误时是(`true`)否(`false`)跳过验证。默认为`true`
                    * 权限：读写
                * `message`
                    * 类型：string
                    * 功能：存储错误消息，如果验证错误则被加入到错误信息中。可使用占位符,占位符将会被使用此校验器的模型中的`generateAttributeLabel()`方法的返回值替换
                        * 默认的占位符
                            * `{attribute}`: 被校验的属性标签
                            * `{value}`: 被校验的属性值 
                        * 自定义占位符
                            * `{占位字符串}`
                    * 权限：读写 
            * 成员方法
                * `protected array|null validateValue($value)`
                    * 功能：验证逻辑,被`validateAttribute()`调用。必需覆写
                    * 参数：value:mixed,要验证的数据
                    * 返回值：bool,通过|未通过验证
                * `public void validateAttribute($model, $attribute)`
                    * 功能：调用验证逻辑(`validateValue()`)与验证结果处理(调用`addError()`添加错误消息),被`validateAttributes()`调用。必需覆写
                    * 参数
                        * model:被验证的模型
                        * attribute:被验证的模型中的属性名
                    * 返回值：bool,通过|未通过验证
    * 属性
        * 成员变量
            * `except`
                * 类型：array
                * 功能：指定此验证器不使用的情景。空数组适用于所有情景
                * 权限：读写。优先级高于`on`
            * `on`
                * 类型：array。此值决定`isActive()`的返回值
                * 功能：指定此验证器使用的情景。空数组适用于所有情景
                * 权限：读写
            * `attributes`
                * 类型：array|string 
                * 功能：要验证的属性名(可能含有`!`前缀)。string只适用于一个属性,array适用于一个或多个属性
                * 权限：读写 
            * `builtInValidators`
                * 类型：static array
                * 功能：验证器与简写对应表
                    * `boolean`: `yii\validators\BooleanValidator`
                    * `captcha`: `yii\captcha\CaptchaValidator`
                    * `compare`: `yii\validators\CompareValidator`
                    * `date`: `yii\validators\DateValidator`
                    * `datetime`: `yii\validators\DateValidator`
                    * `time`: `yii\validators\DateValidator`
                    * `default`: `yii\validators\DefaultValueValidator`
                    * `double`: `yii\validators\NumberValidator`
                    * `each`: `yii\validators\EachValidator`
                    * `email`: `yii\validators\EmailValidator`
                    * `exist`: `yii\validators\ExistValidator`
                    * `file`: `yii\validators\FileValidator`
                    * `filter`: `yii\validators\FilterValidator`
                    * `image`: `yii\validators\ImageValidator`
                    * `in`: `yii\validators\RangeValidator`
                    * `integer`: `yii\validators\NumberValidator`
                    * `match`: `yii\validators\RegularExpressionValidator`
                    * `required`: `yii\validators\RequiredValidator`
                    * `safe`: `yii\validators\SafeValidator`
                    * `string`: `yii\validators\StringValidator`
                    * `trim`: `yii\validators\FilterValidator`
                    * `unique`: `yii\validators\UniqueValidator`
                    * `url`: `yii\validators\UrlValidator`
                    * `ip`: `yii\validators\IpValidator`
                * 权限：只读
            * `isEmpty`
                * 类型：bool callable($value)
                * 功能：空值校验
                * 权限：读写
        * 成员方法
            * `public array getAttributeNames()`
                * 功能：获取真实的属性名称(不含`!`前缀)
                * 参数：无 
                * 返回值: 返回属性名称列表
            * `public array getValidationAttributes($attributes = null)`
                * 功能：获取真实的属性名称(不含`!`前缀)
                * 参数  
                    * attributes
                        * array,属性名称组成的数组
                        * string,只获取一个属性名称,亦可使用字符串
                        * null,获取所有的属性名称
                * 返回值: 返回属性名称列表 
            * `public static yii\validators\Validator createValidator($type, $model, $attributes, $params = [])`
                * 功能：创建校验器实例
                * 参数
                    * type：string|callable,校验器类型,可取以下值
                        * $builtInValidators 列表中的内建校验器名称
                        * 模型类的方法名
                        * 匿名函数
                        * 校验器类名
                    * model：yii\base\Model，被校验的数据模型实例
                    * attributes：array|string,被校验的属性名，它可以是属性名称数组，也可以是逗号分隔的属性名称字符串
                    * params：array,校验器属性的初始值。[属性名=>属性值]
                * 返回值：yii\validators\Validator,生成的校验器实例 
            * `public boolean isEmpty($value)`
                * 功能：检测指定的值是否为空。如果它是一个 null，一个空的数组，或者一个空字符串，那么它会被认为是一个空值
                * 参数：value:mixed,待检测的值
                * 返回值：bool。是|否为空
            * `public boolean validate($value, &$error = null)`
                * 功能：校验一个指定的值。当model调用`validate()时`该函数自动被调用;
                * 参数：
                    * value:mixed,被校验的数据值
                    * error:string,如果校验失败，被返回的错误消息
                * 返回值：bool。数据是|否合法
            * `public void addError($model, $attribute, $message, $params = [])`
                * 功能：为指定的属性添加一条错误消息
                * 参数
                    * model:yii\base\Model,使用这个校验器的模型实例
                    * attribute:string,属性名
                    * error:string,错误消息
                    * params:array,用于替换错误消息中占位符的变量,形式为[占位符字符串(不含中括号)=>变量或值]
                * 返回值：无
            * `public void validateAttributes($model, $attributes = null)`
                * 功能：校验多个指定的值。当model调用`validate()时`该函数自动被调用;
                * 参数：
                    * model：yii\base\Model，被校验的数据模型实例
                    * attributes
                        * array,被校验的属性列表
                        * string,被校验的属性名
                        * null,每个属性都会被校验
                * 返回值：无
            * `public boolean isActive($scenario)`
                * 功能：判断当前校验器在当前情景和属性下是否是激活状态。
                * 参数：scenario:string,情景名
                * 返回值：bool。是|否处于激活状态，以下情况返回true
                    * 这个校验器的 on 属性是空的 
                    * 这个校验器的 on 属性包含指定的情景。
            * `protected string formatMessage($message, $params)`
                * 功能：消息国际化转换。通常在类内处理消息时调用此方法
                * 参数
                    * message:string,将要被转换的消息
                    * params:array,用于替换错误消息中占位符的变量,形式为[占位符字符串(不含中括号)=>变量或值]
                * 返回值：string。转换后的消息
    
    