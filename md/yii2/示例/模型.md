# 模型

## 类名称:`\yii\base\Model`,定义模型需要继承此类

## 属性
* 意义：代表业务数据。典型的场景为表单提交时的字段名称
* 定义属性：`public`关键字定义非静态属性名称 
* 获取所有属性名称：`public array attributes()`
* 访问属性：模型实例可以访问属性的值(亦可使用数组方式访问,这是yii2的特性,不是php的特性)
    ```php
    //设模型A实例为$a,A有公共属性$username,则以下访问方式均可
    //方式一
    echo $a->username;
    //方式二
    echo $a['username'];
    ```
* 属性标签
    * 意义：用于验证规则的错误提示信息以及表单中的输入框名称
    * 默认：自动从属性名生成。它会自动将驼峰式大小写变量名转换为多个首字母大写的单词
    * 自定义:覆写`public string getAttributeLabel($attribute)`方法,示例如下 
        ```php 
        public function attributeLabels()
        {
            //键为属性名,值为显示的标签
            return [
                'name' => 'Your name',
                'email' => 'Your email address',
                'subject' => 'Subject',
                'body' => 'Content',
            ];
        }
        ```
* 安全属性：出现在`rules()`方法中的属性名称前不含有`!`前缀的属性都是安全属性。不需要验证的属性可以添加`safe`验证规则标记为安全属性
* 非安全属性：出现在`rules()`方法中的属性名称前含有`!`前缀的属性是非安全属性 
* 加载属性到模型
    * 块赋值：直接将含有数据的关联数组(要求键名与属性名一一对应)赋值给模型实例的`attributes`。并且只有安全属性可以被赋值
    * 使用方法：

## 场景
* 意义：同一个模型可能会在多个场景下使用，场景用于确定`rules()`中验证规则的适用情形。典型的多场景为用户登录和用户注册。验证规则的"on"属性可指定适用场景
* 默认场景名称：`default`
* 获取当前场景名称：`public string getScenario ( )`
* 声明当前场景：`public void setScenario ( $value )`
    ```php 
    //设模型A实例为$a,假设A有场景"login"和"register",则可以按如下方式声明场景
    //方式一
    $a=new A(["scenario"=>"login"]);
    //方式二
    $a=new A();
    $a->scenario="login";
    ```
* 获取所有场景:`public array scenarios()`。默认返回`rules()`方法中定义好的属性应用场景；覆写此方法同时`rules()`中定义的场景失效
    * 键：场景名称
    * 值：该场景下生效的属性

## 验证规则
* 意义：确定用户输入的值是否符合要求
* 定义验证规则：详见`验证器`
* 开始验证数据：`public boolean validate($attributeNames = null, $clearErrors = true)`

## 数据导出
* 基本方式：`public array toArray(array $fields = [], array $expand = [], $recursive = true)`
    * fields:要返回的`fields()`定义的字段。当为空数组时默认导出所有`fields()`定义的字段
    * expand:要返回的`extraFields()`定义的字段。当为空数组时默认不导出`extraFields()`定义的字段
* 导出的字段定义(被`toArray`的第一个参数调用)：`public array fields()`。默认返回所有的模型属性。
    * `fields()`方法可以定义数据导出的字段别名。默认为属性名
        ```php 
        return [
            //如果元素是一个索引数组,则相当于该属性的`别名`与`属性名`相同
            //如果元素是一个关联数组且值为字符串,则相当于`别名=>属性名`
            //如果元素是一个关联数组且值为匿名函数(参数为当前模型),则相当于指定`别名`的值为匿名函数返回的值 
            'email',
            'firstName' => 'first_name',
            'lastName' => 'last_name',
            'fullName' => function () {
                return $this->first_name . ' ' . $this->last_name;
            },
        ];
        ```
* 导出的字段定义(被`toArray`的第二个参数调用)：`public array extraFields()`。同`fields()`
